var oereoApp = angular.module('oereoApp', [
  'restangular',
  'ngRoute',
  'ngAnimate',
  'ui.bootstrap',
  'directives',
  'filters',
  'factories',
]);

oereoApp.config(function ($routeProvider) {

  $routeProvider
    .when('/', {
      controller: 'ListController',
      templateUrl: '<%= asset_url("templates/resource_list.html") %>',
      resolve: {
        resources: function (Restangular, $route) {
          options = {};

          options.page = $route.current.params.page || 1;

          if ($route.current.params.license_id) {
            options.license_id = $route.current.params.license_id;
          }
          if ($route.current.params.search) {
            options.search = $route.current.params.search;
          }

          console.log('Requested with options:', options);

          return Restangular.all('resources').getList(options);
        }
      }
    })
    .when('/new', {
      controller: 'CreateController',
      templateUrl: '<%= asset_url("templates/resource_detail.html") %>'
    })
    .when('/edit/:resourceId', {
      controller: 'EditController',
      templateUrl: '<%= asset_url("templates/resource_detail.html") %>',
      resolve: {
        resource: function (Restangular, $route) {
          return Restangular.one('resources', $route.current.params.resourceId).get();
        }
      }
    })
    .otherwise({redirectTo: '/'});

});
